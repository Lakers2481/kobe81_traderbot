# Cognitive Architecture

This document provides a comprehensive overview of the advanced cognitive architecture within the kobe81_traderbot project. This architecture represents a significant step beyond simple rule-based trading, introducing a sophisticated, AI-driven decision-making layer that mimics aspects of human cognition.

## 1. High-Level Overview

The cognitive architecture is an optional, advanced processing layer that can be enabled during trading sessions. When active, it intercepts the trading signals generated by the standard strategies (e.g., `DualStrategyScanner`) and subjects them to a deep, deliberative analysis before any action is taken.

The primary goals of this architecture are to:

-   **Improve Decision Quality:** Move beyond rigid, rule-based logic to make more nuanced, context-aware trading decisions.
-   **Enable Autonomous Learning:** Allow the system to learn from its past successes and failures, continuously improving its performance over time.
-   **Increase Robustness:** Adapt to changing market conditions and avoid taking trades when its internal models indicate low confidence.
-   **Provide Explainability:** Generate a clear rationale for each decision, allowing for greater transparency and trust in the system.

This layer is fundamentally designed to be a **"System 2"** thinking process—slow, deliberate, and analytical—in contrast to the fast, intuitive **"System 1"** process of the initial signal generation.

## 2. How to Activate

The cognitive architecture is disabled by default to ensure the bot runs in its most stable, predictable, rule-based mode.

To activate it, use the `--cognitive` flag when running a trading script:

```bash
python scripts/run_paper_trade.py --cognitive
```

When this flag is present, the script will instantiate the `CognitiveBrain` and route all trading signals through it for evaluation.

## 3. Core Components

The cognitive architecture is modular and composed of several specialized components, each responsible for a different aspect of the "thinking" process. These components reside in the `cognitive/` directory.

### 3.1. `CognitiveBrain`

This is the central nervous system of the architecture. It orchestrates the entire deliberative process, from receiving a signal to delivering a final, adjudicated decision.

-   **Key Responsibilities:**
    -   Manages the overall state of the cognitive process.
    -   Coordinates the interaction between all other cognitive components (memory, signal processor, etc.).
    -   Executes the core `deliberate` and `learn_from_outcome` cycles.

### 3.2. `SignalProcessor`

This is the entry point for external information. It takes the raw signals from the strategy scanners and enriches them with additional context and data, preparing them for the main deliberation process.

-   **Key Responsibilities:**
    -   Receives `Signal` objects.
    -   Gathers relevant data from memory and other sources.
    -   Creates a `DecisionPacket`, a rich object containing all information needed for a decision.

### 3.3. `EpisodicMemory`

This component is the system's memory of specific past events. It stores a detailed record of every trade the cognitive agent has observed, participated in, and learned from.

-   **Key Responsibilities:**
    -   Stores `TradeDecision` objects, which include the signal, the decision, and the outcome.
    -   Provides historical context for new decisions (e.g., "What happened the last time I saw a signal like this?").

### 3.4. `SemanticMemory`

This is the system's long-term memory of learned patterns, rules, and associations. It's where the agent's "knowledge" is stored. While `EpisodicMemory` stores *what happened*, `SemanticMemory` stores *what was learned*.

-   **Key Responsibilities:**
    -   Stores learned `schemas` or `patterns` that generalize from specific episodes.
    -   Provides a knowledge base for the `Adjudicator` to use when evaluating signals.

### 3.5. `Adjudicator`

The `Adjudicator` is the core decision-making engine. It takes the `DecisionPacket` and uses the knowledge from `SemanticMemory` and context from `EpisodicMemory` to assess the signal and formulate a recommended action.

-   **Key Responsibilities:**
    -   Evaluates the signal against learned patterns.
    -   Calculates a `confidence_score` for the potential trade.
    -   Recommends a specific action (e.g., `APPROVE`, `REJECT`, `ADJUST_SIZE`).

### 3.6. `ReflectionEngine`

This component is responsible for learning and adaptation. After a trade is completed, the `ReflectionEngine` analyzes the outcome and updates the `SemanticMemory` with new or refined knowledge.

-   **Key Responsibilities:**
    -   Implements the `learn_from_outcome` logic.
    -   Performs periodic `daily_consolidation` and `weekly_consolidation` to analyze recent performance and discover new, high-level patterns.

### 3.7. Other Key Components

-   **`GlobalWorkspace`:** A central blackboard where information from different components can be shared and integrated during the deliberation process.
-   **`KnowledgeBoundary`:** Helps the agent understand the limits of its own knowledge, preventing it from making high-confidence decisions in unfamiliar situations.
-   **`MetacognitiveGovernor`:** A high-level monitor that oversees the cognitive process itself, ensuring the agent is "thinking" effectively and not getting stuck.
-   **`CuriosityEngine`:** Drives the agent to explore and learn about novel or uncertain situations, promoting knowledge acquisition.

## 4. The Cognitive Workflow

The process of handling a signal in cognitive mode follows a clear, multi-step workflow.

### 4.1. The Deliberation Cycle (`deliberate`)

1.  **Signal Reception:** A trading `Signal` is generated by a strategy and sent to the `SignalProcessor`.
2.  **Packet Creation:** The `SignalProcessor` creates a `DecisionPacket` containing the signal and all relevant supporting data.
3.  **Adjudication:** The `CognitiveBrain` passes the packet to the `Adjudicator`. The `Adjudicator` analyzes the packet, consults `EpisodicMemory` and `SemanticMemory`, and calculates a confidence score.
4.  **Decision Formulation:** The `Adjudicator` formulates a `ProposedDecision` (e.g., approve, reject).
5.  **Final Decision:** The `CognitiveBrain` takes the proposed decision and issues a final, `AdjudicatedDecision`, which is then sent to the risk management and execution layers.

### 4.2. The Learning Cycle (`learn_from_outcome`)

1.  **Outcome Reception:** After the trade is executed and closed, the final `outcome` (profit/loss) is sent back to the `CognitiveBrain`.
2.  **Reflection:** The `CognitiveBrain` passes the decision and its outcome to the `ReflectionEngine`.
3.  **Memory Update:** The `ReflectionEngine` analyzes the result. If it was a success, it reinforces the patterns that led to it. If it was a failure, it weakens them or creates new rules to prevent similar failures.
4.  **Knowledge Consolidation:** The updated knowledge is stored in `SemanticMemory` for use in future decisions.

## 5. Conclusion

The cognitive architecture is a powerful and sophisticated extension to the kobe81_traderbot. By enabling this mode, the system transitions from a simple, reactive bot to a thinking, learning, and adapting agent. While more complex, it offers a path to significantly more robust and intelligent trading performance.
