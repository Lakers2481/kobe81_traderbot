# /signals

View raw signals generated by strategies.

## Usage
```
/signals [--strategy NAME] [--date DATE] [--symbol SYMBOL]
```

## What it does
1. Runs strategy signal generation on current data
2. Shows all generated signals with reasons
3. Filters by date, symbol, or strategy
4. Displays signal metadata (RSI values, stops, etc.)

## Commands
```bash
# Generate signals for today
python -c "
import sys
sys.path.insert(0, '.')
from pathlib import Path
from datetime import datetime, timedelta
import pandas as pd

from config.env_loader import load_env
from data.providers.polygon_eod import fetch_eod_bars
from strategies.connors_rsi2.strategy import ConnorsRSI2Strategy
from data.universe.loader import load_universe

load_env(Path('C:/Users/Owner/OneDrive/Desktop/GAME_PLAN_2K28/.env'))

# Load universe
universe = load_universe('data/universe/optionable_liquid_final.csv', cap=50)
print(f'Scanning {len(universe)} symbols...')

# Fetch recent data
end = datetime.now().date()
start = end - timedelta(days=300)

all_signals = []
strategy = ConnorsRSI2Strategy()

for sym in universe[:50]:  # Sample for quick check
    try:
        df = fetch_eod_bars(sym, str(start), str(end))
        if df is not None and len(df) > 200:
            sigs = strategy.generate_signals(df)
            if not sigs.empty:
                all_signals.append(sigs)
    except Exception as e:
        pass

if all_signals:
    result = pd.concat(all_signals, ignore_index=True)
    print()
    print('=== SIGNALS GENERATED ===')
    print(result.to_string(index=False))
else:
    print('No signals generated')
"

# Show recent signal history
python -c "
from pathlib import Path
import json

signals_file = Path('logs/signals.jsonl')
if not signals_file.exists():
    print('No signal history found')
    exit()

print('=== RECENT SIGNALS ===')
lines = signals_file.read_text().splitlines()[-20:]
for line in lines:
    try:
        sig = json.loads(line)
        ts = sig.get('timestamp', '')[:19]
        sym = sig.get('symbol', '?')
        side = sig.get('side', '?')
        reason = sig.get('reason', '')[:40]
        print(f'{ts} {sym:<6} {side:<5} {reason}')
    except:
        pass
"

# Filter signals by symbol
python -c "
import sys
symbol = 'AAPL'  # Change as needed

from pathlib import Path
import json

signals_file = Path('logs/signals.jsonl')
if not signals_file.exists():
    print('No signal history found')
    exit()

print(f'=== SIGNALS FOR {symbol} ===')
for line in signals_file.read_text().splitlines():
    try:
        sig = json.loads(line)
        if sig.get('symbol') == symbol:
            ts = sig.get('timestamp', '')[:19]
            side = sig.get('side', '?')
            entry = sig.get('entry_price', 0)
            stop = sig.get('stop_loss', 0)
            reason = sig.get('reason', '')
            print(f'{ts} {side:<5} entry={entry:.2f} stop={stop:.2f}')
            print(f'         {reason}')
    except:
        pass
"
```

## Signal Format
| Field | Type | Description |
|-------|------|-------------|
| timestamp | datetime | Signal generation time |
| symbol | string | Stock ticker |
| side | string | 'long' or 'short' |
| entry_price | float | Suggested entry |
| stop_loss | float | Protective stop |
| take_profit | float | Target (optional) |
| reason | string | Entry condition details |
| rsi2 | float | RSI(2) value at signal |

## Signal Flow
```
Strategy.generate_signals(df)
    ↓
PolicyGate.check(order)
    ↓
IdempotencyStore.exists(decision_id)
    ↓
broker_alpaca.place_ioc_limit()
```
